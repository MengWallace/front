this.AraleQRCode=function(e){function t(a){if(r[a])return r[a].exports;var o=r[a]={exports:{},id:a,loaded:!1};return e[a].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";e.exports=r(2)},function(e,t,r){"use strict";var a=r(4),o=[],s=r(3),n=function(e){var t=e.options;return t.pdground&&(e.row>1&&e.row<5&&e.col>1&&e.col<5||e.row>e.count-6&&e.row<e.count-2&&e.col>1&&e.col<5||e.row>1&&e.row<5&&e.col>e.count-6&&e.col<e.count-2)?t.pdground:t.foreground},i=function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},l=function(e){"string"==typeof e&&(e={text:e}),this.options=a({},{text:"",render:"",size:256,correctLevel:3,background:"#ffffff",foreground:"#000000",image:"",imageSize:30},e);for(var t=null,r=0,n=o.length;n>r;r++)if(o[r].text==this.options.text&&o[r].text.correctLevel==this.options.correctLevel){t=o[r].obj;break}if(r==n&&(t=new s(this.options.text,this.options.correctLevel),o.push({text:this.options.text,correctLevel:this.options.correctLevel,obj:t})),this.options.render)switch(this.options.render){case"canvas":return this.createCanvas(t);case"table":return this.createTable(t);case"svg":return this.createSVG(t);default:return this.createDefault(t)}return this.createDefault(t)};a(l.prototype,{createDefault:function(e){var t=document.createElement("canvas");if(t.getContext)return this.createCanvas(e);var r="http://www.w3.org/2000/svg";return document.createElementNS&&document.createElementNS(r,"svg").createSVGRect?this.createSVG(e):this.createTable(e)},createCanvas:function(e){var t=this.options,r=document.createElement("canvas"),a=r.getContext("2d"),o=e.getModuleCount(),s=i(a),l=t.size,c=l*s,u=t.imageSize*s,d=function(e,t){var r=new Image;r.src=e,r.onload=function(){t(this),r.onload=null}},p=(c/o).toPrecision(4),h=(c/o).toPrecision(4);r.width=c,r.height=c;for(var f=0;o>f;f++)for(var m=0;o>m;m++){var v=Math.ceil((m+1)*p)-Math.floor(m*p),g=Math.ceil((f+1)*p)-Math.floor(f*p),$=n({row:f,col:m,count:o,options:t});a.fillStyle=e.modules[f][m]?$:t.background,a.fillRect(Math.round(m*p),Math.round(f*h),v,g)}return t.image&&d(t.image,function(e){var t=((c-u)/2).toFixed(2),r=((c-u)/2).toFixed(2);a.drawImage(e,t,r,u,u)}),r.style.width=l+"px",r.style.height=l+"px",r},createTable:function(e){var t=this.options,r=e.getModuleCount(),a=Math.floor(t.size/r),o=Math.floor(t.size/r);0>=a&&(a=80>r?2:1),0>=o&&(o=80>r?2:1);var s=[];s.push('<table style="border:0px; margin:0px; padding:0px; border-collapse:collapse; background-color:'+t.background+';">');for(var i=0;r>i;i++){s.push('<tr style="border:0px; margin:0px; padding:0px; height:'+o+'px">');for(var l=0;r>l;l++){var c=n({row:i,col:l,count:r,options:t});e.modules[i][l]?s.push('<td style="border:0px; margin:0px; padding:0px; width:'+a+"px; background-color:"+c+'"></td>'):s.push('<td style="border:0px; margin:0px; padding:0px; width:'+a+"px; background-color:"+t.background+'"></td>')}s.push("</tr>")}if(s.push("</table>"),t.image){var u=a*r,d=o*r,p=((u-t.imageSize)/2).toFixed(2),h=((d-t.imageSize)/2).toFixed(2);s.unshift("<div style='position:relative;\n                        width:"+u+"px;\n                        height:"+d+"px;'>"),s.push("<img src='"+t.image+"'\n                        width='"+t.imageSize+"'\n                        height='"+t.imageSize+"'\n                        style='position:absolute;left:"+p+"px; top:"+h+"px;'>"),s.push("</div>")}var f=document.createElement("span");return f.innerHTML=s.join(""),f.firstChild},createSVG:function(e){var t=this.options,r=e.getModuleCount(),a=r/t.size,o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("width",t.size),o.setAttribute("height",t.size),o.setAttribute("viewBox","0 0 "+r+" "+r);for(var s=0;r>s;s++)for(var i=0;r>i;i++){var l=document.createElementNS("http://www.w3.org/2000/svg","rect"),c=n({row:s,col:i,count:r,options:t});l.setAttribute("x",i),l.setAttribute("y",s),l.setAttribute("width",1),l.setAttribute("height",1),l.setAttribute("stroke-width",0),e.modules[s][i]?l.setAttribute("fill",c):l.setAttribute("fill",t.background),o.appendChild(l)}if(t.image){var u=document.createElementNS("http://www.w3.org/2000/svg","image");u.setAttributeNS("http://www.w3.org/1999/xlink","href",t.image),u.setAttribute("x",((r-t.imageSize*a)/2).toFixed(2)),u.setAttribute("y",((r-t.imageSize*a)/2).toFixed(2)),u.setAttribute("width",t.imageSize*a),u.setAttribute("height",t.imageSize*a),o.appendChild(u)}return o}}),e.exports=l},function(e,t){"use strict";function r(e){var t,r,a;return 128>e?[e]:2048>e?(t=192+(e>>6),r=128+(63&e),[t,r]):(t=224+(e>>12),r=128+(e>>6&63),a=128+(63&e),[t,r,a])}function a(e){for(var t=[],a=0;a<e.length;a++)for(var o=e.charCodeAt(a),s=r(o),n=0;n<s.length;n++)t.push(s[n]);return t}function o(e,t){this.typeNumber=-1,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.rsBlocks=null,this.totalDataCount=-1,this.data=e,this.utf8bytes=a(e),this.make()}function s(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=new Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}function n(){this.buffer=new Array,this.length=0}o.prototype={constructor:o,getModuleCount:function(){return this.moduleCount},make:function(){this.getRightType(),this.dataCache=this.createData(),this.createQrcode()},makeImpl:function(e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++)this.modules[t]=new Array(this.moduleCount);this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(!0,e),this.typeNumber>=7&&this.setupTypeNumber(!0),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(e,t){for(var r=-1;7>=r;r++)if(!(-1>=e+r||this.moduleCount<=e+r))for(var a=-1;7>=a;a++)-1>=t+a||this.moduleCount<=t+a||(r>=0&&6>=r&&(0==a||6==a)||a>=0&&6>=a&&(0==r||6==r)||r>=2&&4>=r&&a>=2&&4>=a?this.modules[e+r][t+a]=!0:this.modules[e+r][t+a]=!1)},createQrcode:function(){for(var e=0,t=0,r=null,a=0;8>a;a++){this.makeImpl(a);var o=c.getLostPoint(this);(0==a||e>o)&&(e=o,t=a,r=this.modules)}this.modules=r,this.setupTypeInfo(!1,t),this.typeNumber>=7&&this.setupTypeNumber(!1)},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0,null==this.modules[6][e]&&(this.modules[6][e]=e%2==0))},setupPositionAdjustPattern:function(){for(var e=c.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var a=e[t],o=e[r];if(null==this.modules[a][o])for(var s=-2;2>=s;s++)for(var n=-2;2>=n;n++)-2==s||2==s||-2==n||2==n||0==s&&0==n?this.modules[a+s][o+n]=!0:this.modules[a+s][o+n]=!1}},setupTypeNumber:function(e){for(var t=c.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var a=!e&&1==(t>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=a,this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=a}},setupTypeInfo:function(e,t){for(var r=i[this.errorCorrectLevel]<<3|t,a=c.getBCHTypeInfo(r),o=0;15>o;o++){var s=!e&&1==(a>>o&1);6>o?this.modules[o][8]=s:8>o?this.modules[o+1][8]=s:this.modules[this.moduleCount-15+o][8]=s;var s=!e&&1==(a>>o&1);8>o?this.modules[8][this.moduleCount-o-1]=s:9>o?this.modules[8][15-o-1+1]=s:this.modules[8][15-o-1]=s}this.modules[this.moduleCount-8][8]=!e},createData:function(){var e=new n,t=this.typeNumber>9?16:8;e.put(4,4),e.put(this.utf8bytes.length,t);for(var r=0,a=this.utf8bytes.length;a>r;r++)e.put(this.utf8bytes[r],8);for(e.length+4<=8*this.totalDataCount&&e.put(0,4);e.length%8!=0;)e.putBit(!1);for(;!(e.length>=8*this.totalDataCount)&&(e.put(o.PAD0,8),!(e.length>=8*this.totalDataCount));)e.put(o.PAD1,8);return this.createBytes(e)},createBytes:function(e){for(var t=0,r=0,a=0,o=this.rsBlock.length/3,n=new Array,i=0;o>i;i++)for(var l=this.rsBlock[3*i+0],u=this.rsBlock[3*i+1],d=this.rsBlock[3*i+2],p=0;l>p;p++)n.push([d,u]);for(var h=new Array(n.length),f=new Array(n.length),m=0;m<n.length;m++){var v=n[m][0],g=n[m][1]-v;r=Math.max(r,v),a=Math.max(a,g),h[m]=new Array(v);for(var i=0;i<h[m].length;i++)h[m][i]=255&e.buffer[i+t];t+=v;var $=c.getErrorCorrectPolynomial(g),y=new s(h[m],$.getLength()-1),x=y.mod($);f[m]=new Array($.getLength()-1);for(var i=0;i<f[m].length;i++){var b=i+x.getLength()-f[m].length;f[m][i]=b>=0?x.get(b):0}}for(var w=new Array(this.totalDataCount),C=0,i=0;r>i;i++)for(var m=0;m<n.length;m++)i<h[m].length&&(w[C++]=h[m][i]);for(var i=0;a>i;i++)for(var m=0;m<n.length;m++)i<f[m].length&&(w[C++]=f[m][i]);return w},mapData:function(e,t){for(var r=-1,a=this.moduleCount-1,o=7,s=0,n=this.moduleCount-1;n>0;n-=2)for(6==n&&n--;;){for(var i=0;2>i;i++)if(null==this.modules[a][n-i]){var l=!1;s<e.length&&(l=1==(e[s]>>>o&1));var u=c.getMask(t,a,n-i);u&&(l=!l),this.modules[a][n-i]=l,o--,-1==o&&(s++,o=7)}if(a+=r,0>a||this.moduleCount<=a){a-=r,r=-r;break}}}},o.PAD0=236,o.PAD1=17;for(var i=[1,0,3,2],l={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},c={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;c.getBCHDigit(t)-c.getBCHDigit(c.G15)>=0;)t^=c.G15<<c.getBCHDigit(t)-c.getBCHDigit(c.G15);return(e<<10|t)^c.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;c.getBCHDigit(t)-c.getBCHDigit(c.G18)>=0;)t^=c.G18<<c.getBCHDigit(t)-c.getBCHDigit(c.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return c.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case l.PATTERN000:return(t+r)%2==0;case l.PATTERN001:return t%2==0;case l.PATTERN010:return r%3==0;case l.PATTERN011:return(t+r)%3==0;case l.PATTERN100:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case l.PATTERN101:return t*r%2+t*r%3==0;case l.PATTERN110:return(t*r%2+t*r%3)%2==0;case l.PATTERN111:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new s([1],0),r=0;e>r;r++)t=t.multiply(new s([1,u.gexp(r)],0));return t},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0,o=0;t>o;o++)for(var s=0,n=e.modules[o][0],i=0;t>i;i++){var l=e.modules[o][i];if(t-6>i&&l&&!e.modules[o][i+1]&&e.modules[o][i+2]&&e.modules[o][i+3]&&e.modules[o][i+4]&&!e.modules[o][i+5]&&e.modules[o][i+6]&&(t-10>i?e.modules[o][i+7]&&e.modules[o][i+8]&&e.modules[o][i+9]&&e.modules[o][i+10]&&(r+=40):i>3&&e.modules[o][i-1]&&e.modules[o][i-2]&&e.modules[o][i-3]&&e.modules[o][i-4]&&(r+=40)),t-1>o&&t-1>i){var c=0;l&&c++,e.modules[o+1][i]&&c++,e.modules[o][i+1]&&c++,e.modules[o+1][i+1]&&c++,(0==c||4==c)&&(r+=3)}n^l?s++:(n=l,s>=5&&(r+=3+s-5),s=1),l&&a++}for(var i=0;t>i;i++)for(var s=0,n=e.modules[0][i],o=0;t>o;o++){var l=e.modules[o][i];t-6>o&&l&&!e.modules[o+1][i]&&e.modules[o+2][i]&&e.modules[o+3][i]&&e.modules[o+4][i]&&!e.modules[o+5][i]&&e.modules[o+6][i]&&(t-10>o?e.modules[o+7][i]&&e.modules[o+8][i]&&e.modules[o+9][i]&&e.modules[o+10][i]&&(r+=40):o>3&&e.modules[o-1][i]&&e.modules[o-2][i]&&e.modules[o-3][i]&&e.modules[o-4][i]&&(r+=40)),n^l?s++:(n=l,s>=5&&(r+=3+s-5),s=1)}var u=Math.abs(100*a/t/t-50)/5;return r+=10*u}},u={glog:function(e){if(1>e)throw new Error("glog("+e+")");return u.LOG_TABLE[e]},gexp:function(e){for(;0>e;)e+=255;for(;e>=256;)e-=255;return u.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},d=0;8>d;d++)u.EXP_TABLE[d]=1<<d;for(var d=8;256>d;d++)u.EXP_TABLE[d]=u.EXP_TABLE[d-4]^u.EXP_TABLE[d-5]^u.EXP_TABLE[d-6]^u.EXP_TABLE[d-8];for(var d=0;255>d;d++)u.LOG_TABLE[u.EXP_TABLE[d]]=d;s.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var a=0;a<e.getLength();a++)t[r+a]^=u.gexp(u.glog(this.get(r))+u.glog(e.get(a)));return new s(t,0)},mod:function(e){var t=this.getLength(),r=e.getLength();if(0>t-r)return this;for(var a=new Array(t),o=0;t>o;o++)a[o]=this.get(o);for(;a.length>=r;){for(var n=u.glog(a[0])-u.glog(e.get(0)),o=0;o<e.getLength();o++)a[o]^=u.gexp(u.glog(e.get(o))+n);for(;0==a[0];)a.shift()}return new s(a,0)}};var p=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];o.prototype.getRightType=function(){for(var e=1;41>e;e++){var t=p[4*(e-1)+this.errorCorrectLevel];if(void 0==t)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+this.errorCorrectLevel);for(var r=t.length/3,a=0,o=0;r>o;o++){var s=t[3*o+0],n=t[3*o+2];a+=n*s}var i=e>9?2:1;if(this.utf8bytes.length+i<a||40==e){this.typeNumber=e,this.rsBlock=t,this.totalDataCount=a;break}}},n.prototype={get:function(e){var t=Math.floor(e/8);return this.buffer[t]>>>7-e%8&1},put:function(e,t){for(var r=0;t>r;r++)this.putBit(e>>>t-r-1&1)},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=o},function(e,t){e.exports=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),a=0;t=r[a];a++)if(t)for(var o in t)e[o]=t[o];return e}}]),function(e,t,r,a){function o(t,r){function a(){var t=o.elem.val();t=t?t:o.opts.defaultDate;var r=' <div class="inline date-holder"></div>',a='<div> <input type="number" pattern="d*" maxlength="2" min="1" max="31" class="form-control input-mask" placeholder="日" data-mask="00"> </div><br>',s='<div class="has-feedback"> <select class="form-control" placeholder="月"> <option value="1">1 月</option> <option value="2">2 月</option> <option value="3">3 月</option> <option value="4">4 月</option> <option value="5">5 月</option> <option value="6">6 月</option> <option value="7">7 月</option> <option value="8">8 月</option> <option value="9">9 月</option> <option value="10">10 月</option> <option value="11">11 月</option> <option value="12">12 月</option> </select> <span class="zmdi zmdi-caret-down form-control-feedback"></span></div>',n='<div><input type="number" pattern="d*" maxlength="4"   min="1950" max="2020" class="form-control input-mask"  data-mask="0000" placeholder="年"></div>',i='<small class="help-block with-errors"></small>';o.opts.holder=e(r),o.opts.day=e(a),o.opts.month=e(s),o.opts.year=e(n),o.opts.error=e(i);var l=Date.parse(t);if(isNaN(l))l=new Date;else{var l=new Date(l);o.elem.val(l),e("input",o.opts.year).val(l.getFullYear()),e("select",o.opts.month).val(l.getMonth()+1),e("input",o.opts.day).val(l.getDate())}o.elem.prop("required");o.opts.holder.append(o.opts.year),o.opts.holder.append(o.opts.month),o.opts.holder.append(o.opts.day),o.opts.holder.append(o.opts.error),o.elem.after(o.opts.holder),o.elem.prop("type","hidden");var c=function(t){try{var r=e("input",o.opts.year).val(),a=e("input",o.opts.day).val(),s=new Date(r,e("select",o.opts.month).val()?parseInt(e("select",o.opts.month).val())-1:"",a);console.log(s),o.elem.val(s),o.opts.error.text(""),e("input",o.opts.year).val(s.getFullYear()),e("select",o.opts.month).val(s.getMonth()+1),e("input",o.opts.day).val(s.getDate())}catch(e){o.elem.val(""),o.opts.error.text("请输入有效的日期"),console.log(e)}};e("input",o.opts.year).on("change",c),e("select",o.opts.month).on("change",c),e("input",o.opts.day).on("change",c)}var o=this;o.opts=e.extend({},n,r),o.elem=e(t),a()}var s="datepicker",n={className:"fg-line",defaultDate:new Date};e.fn[s]=function(t){return this.each(function(){e.data(this,s)||e.data(this,s,new o(this,t))})}}(jQuery,window,document);var PreferenceApp=function(){function e(){!function(){Waves.attach(".btn:not(.btn-icon):not(.btn-float)"),Waves.attach(".btn-icon, .btn-float",["waves-circle","waves-float"]),Waves.init()}(),$("[data-hide]").on("click",function(){$(this).closest("."+$(this).attr("data-hide")).addClass("hide")}),$(document).ajaxComplete(function(e,t,r){401===t.status&&window.location.reload()})}function t(){$(".fg-line")[0]&&($("body").on("focus",".fg-line .form-control",function(){$(this).closest(".fg-line").addClass("fg-toggled")}),$("body").on("blur",".form-control",function(){var e=$(this).closest(".form-group, .input-group"),t=e.find(".form-control").val();e.hasClass("fg-float")?0==t.length&&$(this).closest(".fg-line").removeClass("fg-toggled"):$(this).closest(".fg-line").removeClass("fg-toggled")})),$(".fg-float")[0]&&$(".fg-float .form-control").each(function(){var e=$(this).val();0==!e.length&&$(this).closest(".fg-line").addClass("fg-toggled")})}function r(e,t){$.notify({message:e},{type:t,allow_dismiss:!1,label:"Cancel",className:"btn-xs btn-inverse",delay:800,animate:{enter:"animated fadeInRight",exit:"animated fadeOutRight"},offset:{x:30,y:30}})}function a(){var e=document.location.hash;o(e),$(window).on("hashchange",function(){o(window.location.hash)})}function o(e){void 0!=e&&""!=e||(e="#home"),e=e.substring(1),""!=e&&($("[data-href-toggle]").hide(),$("[data-href-toggle$="+e+"]").show(),$(".nav-hash").removeClass("active"),$(".nav-hash a[href$='#"+e+"']").closest("li").addClass("active"),"home"==e?AppSecurity.init():"history"==e?AppHistory.init():"permissions"==e&&AppPermissions.init())}function s(){$(".inline-edit").on("click",function(e){e.preventDefault(),$(this).closest(".pmb-block").toggleClass("toggled")}),$(".inline-edit-cancel").on("click",function(e){e.preventDefault(),$(this).closest(".pmb-block").toggleClass("toggled")})}function n(){$.ajax({type:"GET",cache:!1,url:"apis/preference/profile",dataType:"json",headers:{Accept:"application/json"},success:function(e){i(e.name,e.avatarurl,e.email),$(".page-loader").hide(),AppProfileEditor.updateProfileMain(e)},error:function(e,t,r){console.log("error to fetch info")}})}function i(e,t,r){u.find(".him-label").text(e),""==t||void 0==t?(u.find(".avatar").attr("style","background:"+c(e)),u.find(".avatar").text(e.charAt(0))):(u.find(".avatar").attr("style","background:url("+t+")"),u.find(".avatar").text("")),u.find(".him-label-email").text(r)}function l(){n(),e(),a(),s(),t()}var c=function(e){for(var t=0,r=0;r<e.length;r++)t+=e.charCodeAt(r);const a=t%360;return"hsl("+a+",60%,75%)"},u=($("#content"),$("#header-alt"));return{init:l,notify:r,updateHeader:i,textToColor:c,toggleInlineEditor:s}}(),AppProfileEditor=function(){function e(){function e(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$(".upload-pic").addClass("ready"),r.croppie("bind",{url:e.target.result}).then(function(){})},t.readAsDataURL(e.files[0])}}var r;r=$(".upload-pic-holder").croppie({viewport:{width:150,height:150,type:"square"},boundary:{width:260,height:260},enableZoom:!0,enableExif:!0}),$("#upload").on("change",function(){e(this)}),$(".upload-result").on("click",function(e){r.croppie("result",{type:"canvas",size:{width:300,height:300},format:"jpeg",quality:.9}).then(function(e){$(".upload-pic").removeClass("ready"),t({src:e})})})}function t(e){$(".upload-result-holder").attr("style","background:url("+e.src+")"),$(".upload-result-holder").text(""),$.ajax({type:"POST",headers:{Accept:"application/json"},url:"apis/preference/profile",contentType:"application/json; charset=utf-8",data:JSON.stringify({avatarurl:e.src}),success:function(t){PreferenceApp.updateHeader(t.name,e.src,t.email)},error:function(e,t,r){}})}function r(e){return"male"==e?"男":"female"==e?"女":"other"==e?"其它":"未知"}function a(t){t.sexName=r(t.sex),t.birthdayDateFormat=moment(new Date(t.birthday)).format("YYYY年MM月DD日"),void 0!=n&&(t.createdat=moment(new Date(t.createdat)).format("YYYY年MM月DD日"),$("#profile-body").html(Mustache.render(n,t)),""==t.avatarurl||void 0==t.avatarurl?($("#profile-body").find(".avatar").attr("style","background:"+PreferenceApp.textToColor(t.name)),$("#profile-body").find(".avatar").text(t.name.charAt(0))):$("#profile-body").find(".avatar").attr("style","background:url("+t.avatarurl+")"),PreferenceApp.toggleInlineEditor(),e(),$(".date-picker").datepicker({defaultDate:new Date(t.birthday)}),o())}function o(){$("#profile-basic-update").validator().submit(function(e){if(!e.isDefaultPrevented()){var t=$(e.target);e.preventDefault();var r=t.serializeArray(),o={};$.each(r,function(e,t){t.value&&(o[t.name]=t.value)}),o.birthday&&(o.birthday=moment(new Date(o.birthday)).format("YYYY-MM-DDTHH:mm:ssZ")),$.ajax({type:"POST",url:"apis/preference/profile",data:JSON.stringify(o),contentType:"application/json; charset=utf-8",success:function(e){PreferenceApp.updateHeader(e.name,e.avatarurl,e.email),a(e)},error:function(e,t,r){console.log(e)}})}})}function s(){}var n=$("#profile-body").html();return{init:s,updateProfileMain:a}}(),AppPermissions=function(){function e(){$.ajax({type:"GET",url:"apis/preference/linkedaccounts",dataType:"json",cache:!1,headers:{Accept:"application/json"},success:function(e){n=$("#linked-accounts-template").html();for(var t=0;t<e.length;t++)e[t].logouri?(e[t].backgroundimage="url("+e[t].logouri+")",e[t].avatarclass="b-r-0"):(e[t].background=PreferenceApp.textToColor(e[t].name),e[t].bgcontent=e[t].name.charAt(0),e[t].avatarclass="b-0");i=e,$("#linked-accounts-body").html(Mustache.render(n,{data:i}))},error:function(e,t,r){$("#linked-accounts-body").html('<p class="text-center list-group-normal">没有绑定任何帐号。</p>')}})}function t(){$.ajax({type:"GET",cache:!1,url:"apis/preference/permissions",dataType:"json",headers:{Accept:"application/json"},success:function(e){for(var t=0;t<e.length;t++){e[t].client.logouri?(e[t].client.background="url("+e[t].client.logouri+")",e[t].client.avatarclass="b-r-0"):(e[t].client.background=PreferenceApp.textToColor(e[t].client.name),e[t].client.bgcontent=e[t].client.name.charAt(0),e[t].client.avatarclass="b-0"),e[t].scopedescription="";var r=e[t].scopes.length;r>3&&(r=3);for(var a=0;a<r;a++)a==r-1?e[t].scopedescription+=e[t].scopes[a].summary:e[t].scopedescription+=e[t].scopes[a].summary+", ";e[t].createdat=moment(new Date(e[t].createdat)).format("YYYY年MM月DD日"),3==r&&(e[t].scopedescription+="...")}u=e,$("#permissions-body").html(Mustache.render(l,{data:u}))},error:function(e,t,r){$("#permissions-body").html('<p class="text-center list-group-normal">没有授权任何应用。</p>')}})}function r(e){for(var t=0;t<u.length;t++){var r=u[t];r.client.id==e&&($("#modal-holder").html(Mustache.render(c,r)),$("#modal-holder").modal("show"))}return!0}function a(e){$.ajax({type:"DELETE",url:"apis/preference/linkedaccounts?host="+e,dataType:"json",headers:{Accept:"application/json"},success:function(e){console.log(e)}});for(var t=0;t<i.length;t++)i[t].host==e&&i.splice(t,1);$("#linked-accounts-body").html(Mustache.render(n,{data:i}))}function o(e){$.ajax({type:"DELETE",url:"apis/preference/permissions?id="+e,dataType:"json",headers:{Accept:"application/json"},success:function(e){console.log(e)}});for(var t=0;t<u.length;t++)u[t].client.id==e&&u.splice(t,1);return $("#permissions-body").html(Mustache.render(l,{data:u})),$("#modal-holder").html(""),$("#modal-holder").modal("hide"),!0}function s(){d||(e(),t())}var n,i=[],l=$("#permissions-template").html(),c=$("#permission-scopes-template").html(),u=[],d=!1;return{init:s,showScope:r,revokeClient:o,revokeLinkedAccount:a}}(),AppHistory=function(){function e(){$.ajax({type:"GET",cache:!1,url:"apis/preference/logs",dataType:"json",headers:{Accept:"application/json"},success:function(e){i=e;for(var t=0;t<e.length;t++)e[t].id=t+1;s(i,1,l),e.length>l&&$(".page-selection").bootpag({total:e.length/l+1,maxVisible:5,nextClass:"zmdi",prevClass:"zmdi"}).on("page",function(e,t){s(i,t,l)})},error:function(e,t,r){var a=$("#history-table-error").html();$("#history-table").html(Mustache.render(a,{error:""}))}})}function t(e){var t=new UAParser(e).getResult();return t.browser.name+" "+t.browser.major+" ( "+t.os.name+" "+t.os.version+" )"}function r(e){return void 0!=f[e]?void a(e,f[e]):(f[e]="正在加载...",void $.ajax({type:"GET",cache:!1,url:"https://geoip.nekudo.com/api/"+e.replace(/:\s*/g,"%3a")+"/zh",dataType:"jsonp",success:function(t){"error"==t.type?a(e,"未知"):a(e,t.city)},error:function(t,r,o){a(e,"未知")}}))}function a(e,t){f[e]=t;for(var r=$(".ip-"+e.replace(/\.|:\s*/g,"-")),a=0;a<h.length;a++)h[a].ip==e&&(h[a].addr=t);r&&r.html(t)}function o(e){return void 0!=d[e]?d[e]:e}function s(e,a,s){p=a;var n=(a-1)*s,i=n+s,l=e.slice(n,i);if(void 0!=c[a])return void $("#history-table").html(Mustache.render(u,c[a]));h=[];for(var d=0;d<l.length;d++)h.push({id:l[d].id,time:moment(new Date(l[d].createdat)).format("MM月DD日 hh:mm"),ip:l[d].ip,addr:"正在查询...",ipclass:"ip-"+l[d].ip.replace(/\.|:\s*/g,"-"),device:t(l[d].useragent),type:o(l[d].type)}),r(l[d].ip);c[a]={data:h},$("#history-table").html(Mustache.render(u,{data:h}))}function n(){m||(e(),m=!0)}var i=[],l=15,c={},u=$("#history-table-template").html(),d={LOGIN:"登录"},p=0,h=[],f={},m=!1;return{init:n}}(),AppSecurity=function(){function e(){$("#modal-sudo").find("form").validator().submit(function(e){if(!e.isDefaultPrevented()){var t=$(e.target),r=$(".alert",t);r.addClass("hide"),e.preventDefault();var a=t.serializeArray();$.ajax({type:"POST",url:"apis/preference/sudo",headers:{Accept:"application/json"},data:a,success:function(e){t.closest(".modal").modal("hide"),t.trigger("reset"),void 0!=g&&($(g).modal("show"),g=void 0)},error:function(e,t,a){$("text",r).text("密码不正确,请重试。"),r.removeClass("hide")}})}})}function t(e){g=e,$("#modal-sudo").modal("show")}function r(){$.ajax({type:"GET",cache:!1,headers:{Accept:"application/json"},url:"apis/preference/status",dataType:"json",success:function(e){v=e,a(),d(),i()},error:function(e,t,r){$("#home-security-body").html("载入错误,请重试")}})}function a(){var e={points:0,riskcount:0},t=v;t.password.ok||e.riskcount++,t.password.desc="用于保护账户信息和安全登录",t.email.ok?t.email.desc="安全邮箱可以用于登录，重置密码或其他安全验证":(e.riskcount++,t.email.desc="安全邮箱可以用于登录，重置密码，请立即设置"),t.phone.ok?t.phone.desc="安全手机可以用于登录，重置密码或其他安全验证":(e.riskcount++,t.phone.desc="安全手机可以用于登录，重置密码，请立即设置"),t.qa.ok?(p(v.qa.data.qas),t.qa.desc="密保问题用于安全验证, 请牢记。"):(e.riskcount++,t.qa.desc="密保问题用于安全验证,请立即设置。"),e.points=100*(1-e.riskcount/4),t.score=e,$("#home-security-body").html(Mustache.render(m,v)),t.password.ok?($("#modal-password-org").show(),$("#modal-password-org").find("input").val("")):($("#modal-password-org").hide(),$("#modal-password-org").find("input").val("emp"))}function o(){$("#form-password-reset").validator().submit(function(e){if(!e.isDefaultPrevented()){var t=$(e.target),r=$(".alert",t);r.addClass("hide"),e.preventDefault();var o=t.serializeArray();$.ajax({type:"POST",url:"apis/preference/password",headers:{Accept:"application/json"},data:o,success:function(e){t.closest(".modal").modal("hide"),$("#form-password-reset").trigger("reset"),PreferenceApp.notify("密码设置成功"),v.password.ok=!0,a()},error:function(e,t,a){$("text",r).text("原密码不正确,请重试。"),r.removeClass("hide")}})}})}function s(){$("#email-reset-step1 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var a=t.serializeArray();v.data=a[0].value,$.ajax({type:"POST",url:"apis/preference/securitytoken",headers:{Accept:"application/json"},data:a,success:function(e){$("#email-reset-step1 form").trigger("reset"),$("#email-reset-step1").removeClass("active"),$("#email-reset-step2").addClass("active")},error:function(e,t,a){302==e.status?location.reload():400==e.status?$("text",r).text("密码不正确,请重试。"):409==e.status?$("text",r).text("该邮箱已被注册,请使用其它邮箱地址。"):406==e.status?$("text",r).text("新手邮箱不能和旧邮箱相同"):$("text",r).text("系统错误,请稍后重试。"),r.removeClass("hide")}})}}),$("#email-reset-step2 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var o=t.serializeArray();if(6!=o[0].value.length)return $("text",r).text("验证码必须为6位。"),void r.removeClass("hide");o[1].value=v.data,$.ajax({type:"GET",cache:!1,url:"apis/preference/securitytoken",headers:{Accept:"application/json"},data:o,success:function(e){$("#email-reset-step2 form").trigger("reset"),$("#email-reset-step1").addClass("active"),$("#email-reset-step2").removeClass("active"),t.closest(".modal").modal("hide"),PreferenceApp.notify("邮件地址修改成功"),v.email.data=v.data,$(".him-label-email").text(v.email.data),a()},error:function(e,t,a){302==e.status?location.reload():400==e.status?$("text",r).text("验证码不正确,请重试。"):409==e.status?$("text",r).text("该邮箱已被注册,请使用其它邮箱地址。"):406==e.status?$("text",r).text("新手邮箱不能和旧邮箱相同"):$("text",r).text("系统错误,请稍后重试。"),r.removeClass("hide")}}),$("#email-reset-step2 .cancel").on("click",function(e){$("#email-reset-step1").addClass("active"),
$("#email-reset-step2").removeClass("active"),$(e.target).closest("form").trigger("reset")})}})}function n(){$("#phone-reset-step1 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var a=t.serializeArray();if(11!=a[0].value.length)return $("text",r).text("请输入正确的中国大陆手机号码。"),void r.removeClass("hide");v.data=a[0].value,a[0].value="+86 "+a[0].value,$.ajax({type:"POST",url:"apis/preference/securitytoken",headers:{Accept:"application/json"},data:a,success:function(e){$("#phone-reset-step1 form").trigger("reset"),$("#phone-reset-step1").removeClass("active"),$("#phone-reset-step2").addClass("active")},error:function(e,t,a){400==e.status?$("text",r).text("密码不正确,请重试。"):409==e.status?$("text",r).text("该手机号码已被注册,请使用其它手机号码。"):406==e.status?$("text",r).text("新手机号码不能和旧手机号码相同"):$("text",r).text("系统错误,请稍后重试。"),r.removeClass("hide")}})}}),$("#phone-reset-step2 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var o=t.serializeArray();if(6!=o[0].value.length)return $("text",r).text("验证码必须为6位。"),void r.removeClass("hide");o[1].value="+86 "+v.data,$.ajax({type:"GET",cache:!1,url:"apis/preference/securitytoken",data:o,headers:{Accept:"application/json"},success:function(e){$("#phone-reset-step2 form").trigger("reset"),$("#phone-reset-step1").addClass("active"),$("#phone-reset-step2").removeClass("active"),t.closest(".modal").modal("hide"),PreferenceApp.notify("修改手机号码成功"),v.phone.data=v.data,a()},error:function(e,t,a){406==e.status?$("text",r).text("验证码尝试次数过多,请重新获取验证码"):$("text",r).text("验证码不正确或已经过期,请确保手机时间和标准时间同步后重试"),r.removeClass("hide")}})}}),$("#phone-reset-step2 .cancel").on("click",function(e){$(e.target).closest("form").trigger("reset"),$("#phone-reset-step2").removeClass("active"),$("#phone-reset-step1").addClass("active")})}function i(){$("form .cancel").on("click",function(e){$(e.target).closest("form").trigger("reset")})}function l(){$(".input-text-group a").on("click",function(e){var t=e.target,r=$($(e.target).parent().parent().parent().children()[0]);t.hasAttribute("data-custom")?(r.val(""),r.attr("placeholder",t.innerText),r.removeAttr("data-toggle"),r.focus()):(r.val(t.innerText),r.attr("data-toggle","dropdown"),r.parent().find(".with-errors").html(""),r.closest(".form-group").removeClass("has-error").removeClass("has-danger")),e.preventDefault()})}function c(){$("#qa-step2 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var o=t.serializeArray(),s=[{},{}];s[0].q=o[0].value,s[0].a=o[1].value,s[1].q=o[2].value,s[1].a=o[3].value;var n={};n.token=v.token,n.qas=s,$.ajax({type:"POST",url:"apis/preference/qa",headers:{Accept:"application/json"},data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(e){$("#qa-step1 form").trigger("reset"),$("#qa-step2 form").trigger("reset"),t.closest(".modal").modal("hide"),$("#qa-step1").addClass("active"),$("#qa-step2").removeClass("active"),v.qa.ok=!0,v.qa.data={},v.qa.data.qas=n.qas,console.log(v.qa.data.qas),a(),PreferenceApp.notify("密保问题设置成功")},error:function(e,t,a){$("text",r).text("设置错误,请稍后重试。"),r.removeClass("hide")}})}}),$("#qa-step2 .btn-back").on("click",function(e){$("#qa-step2 form").trigger("reset"),$("#qa-step2").removeClass("active"),$("#qa-step1").addClass("active")}),$("#qa-step2 .cancel").on("click",function(e){$("#qa-step2 form").trigger("reset"),$("#qa-step1 form").trigger("reset"),$("#qa-step2").removeClass("active"),$("#qa-step1").addClass("active")})}function u(){$("#qa-step1 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var a={};if($.each(t.serializeArray(),function(e,t){a[t.name]=t.value}),a.q1==a.q2)return $("text",r).text("两个密保问题不能相同, 请使用两个不同的密保问题"),void r.removeClass("hide");if(a.a1==a.a2)return $("text",r).text("两个密保的答案不能相同,请使用不同的答案"),void r.removeClass("hide");var o=$("#form-qa-step2-template").html();$("#qa-step2 .modal-body").html(Mustache.render(o,a)),$("#qa-step1").removeClass("active"),$("#qa-step2").addClass("active"),c(),f=a}})}function d(){var e=$("#ts-2step");e.prop("checked",v.twostepsstatus.ok),e.change(function(){t(this.checked?"#modal-2step":"#modal-2step-manage")}),$("#modal-2step .cancel").on("click",function(t){e.prop("checked",v.twostepsstatus.ok),$("#2step-step2").removeClass("active"),$("#2step-step3").removeClass("active"),$("#2step-step4").removeClass("active"),$("#2step-step1").addClass("active"),$("#2step-show-secret").addClass("hidden"),$("#2step-show-qrcode").removeClass("hidden")}),$("#modal-2step-manage .cancel").on("click",function(e){$("#modal-2step .cancel").trigger("click")}),$("#modal-2step-manage  button[type=submit]").on("click",function(e){$.ajax({type:"DELETE",url:"apis/preference/twofactor",headers:{Accept:"application/json"},success:function(e){v.twostepsstatus.ok=!1,$("#modal-2step-manage .cancel").trigger("click")},error:function(e,t,r){PreferenceApp.notify("服务器异常,请稍后重试","danger"),$("#modal-2step .cancel").trigger("click")}})}),$("#2step-step2 button[type=submit]").on("click",function(e){$.ajax({type:"PUT",url:"apis/preference/twofactor",headers:{Accept:"application/json"},success:function(e){var t="otpauth://totp/TiUP:"+v.email.data+"?issuer=TiUP&secret="+e.secret;$("#2step-show-secret pre").text(e.secret.replace(/(\S{4}(?!\s))/g,"$1 ")),$("#2step-qrcode").html(new AraleQRCode({correctLevel:0,size:160,text:t})),$("#2step-step2").removeClass("active"),$("#2step-step3").addClass("active")},error:function(e,t,r){PreferenceApp.notify("服务器异常,请稍后重试","danger"),$("#modal-2step .cancel").trigger("click")}})}),$('a[href$="#2step-show-secret"]').on("click",function(e){e.preventDefault(),$("#2step-show-secret").removeClass("hidden"),$("#2step-show-qrcode").addClass("hidden")}),$("#2step-step3 form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".form-group",t);r.removeClass("has-error"),$(".with-errors",r).text("");var a=t.serializeArray();$.ajax({type:"POST",url:"apis/preference/twofactor",headers:{Accept:"application/json"},data:a,success:function(e){v.twostepsstatus.ok=!0,$("#2step-step3 form").trigger("reset");var t=$("#twostep-recovery-template").html();$("#twostep-recovery").html(Mustache.render(t,e)),$("#2step-step3").removeClass("active"),$("#2step-step4").addClass("active"),$(".with-errors",r).text(""),r.removeClass("has-error")},error:function(e,t,a){406==e.status?$(".with-errors",r).text("二次认证申请失效,请取消并重新申请"):$(".with-errors",r).text("验证码不正确或已经过期,请重试"),r.addClass("has-error")}})}})}function p(e){for(var t=0;t<e.length;t++)e[t].index=t+1;$("#qa-validate-template").next(".modal-body").html(Mustache.render(y,{qas:e})),$("#modal-qa-validate form").validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(e.target),r=$(".alert",t);r.addClass("hide");var a=t.serializeArray(),o=[{},{}];o[0].q=a[0].value,o[0].a=a[1].value,o[1].q=a[2].value,o[1].a=a[3].value,$.ajax({type:"GET",cache:!1,url:"apis/preference/qa?data="+JSON.stringify(o),headers:{Accept:"application/json"},success:function(e){console.log(e),t.closest(".modal").modal("hide"),v.token=e.token,$("#modal-qa-validate form").trigger("reset"),$("#"+x).modal("show")},error:function(e,t,a){$("text",r).text("密保问题不匹配,请重试。"),r.removeClass("hide")}})}})}function h(){r(),o(),s(),n(),l(),u(),e()}var f,m=$("#home-security-template").html(),v=void 0,g=void 0,y=$("#qa-validate-template").html(),x="modal-qa-reset";return{init:h,sudo:t}}();jQuery(document).ready(function(){PreferenceApp.init()});